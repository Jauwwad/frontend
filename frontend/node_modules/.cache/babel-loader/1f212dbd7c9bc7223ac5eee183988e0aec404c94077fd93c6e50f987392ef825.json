{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Box,Container,Typography,Grid,Card,CardContent,Button,AppBar,Toolbar,IconButton,Menu,MenuItem,Chip,LinearProgress,Alert,Paper,List,ListItem,ListItemIcon,ListItemText,Avatar}from'@mui/material';import{Nature as NatureIcon,AccountCircle as AccountIcon,Add as AddIcon,Visibility as ViewIcon,TrendingUp as TrendingUpIcon,Schedule as ScheduleIcon,CheckCircle as CheckCircleIcon,Warning as WarningIcon,PhotoCamera as PhotoIcon,LocationOn as LocationIcon,Assessment as AssessmentIcon}from'@mui/icons-material';import{useAuth}from'../contexts/AuthContext';import{useSnackbar}from'notistack';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserDashboard=()=>{var _user$name;const navigate=useNavigate();const{user,logout}=useAuth();const{enqueueSnackbar}=useSnackbar();const[anchorEl,setAnchorEl]=useState(null);const[userProjects,setUserProjects]=useState([]);const[dashboardStats,setDashboardStats]=useState({total_projects:0,approved_projects:0,pending_projects:0,total_credits:0});const[loading,setLoading]=useState(true);useEffect(()=>{fetchUserData();},[]);const fetchUserData=async()=>{try{// Fetch user's projects\nconst response=await fetch('http://localhost:8002/api/projects');const data=await response.json();if(data.status==='success'){// Filter projects for current user (demo - all projects shown)\nconst projects=data.projects||[];setUserProjects(projects);// Calculate user stats\nconst approved=projects.filter(p=>p.status==='approved').length;const pending=projects.filter(p=>['pending_verification','requires_review'].includes(p.status)).length;const totalCredits=projects.reduce((sum,p)=>sum+(p.carbon_credits||0),0);setDashboardStats({total_projects:projects.length,approved_projects:approved,pending_projects:pending,total_credits:totalCredits});}}catch(error){console.error('Error fetching user data:',error);enqueueSnackbar('Failed to load dashboard data',{variant:'error'});}finally{setLoading(false);}};const handleMenuOpen=event=>{setAnchorEl(event.currentTarget);};const handleMenuClose=()=>{setAnchorEl(null);};const handleLogout=()=>{logout();navigate('/');enqueueSnackbar('Logged out successfully',{variant:'success'});};const getProjectStatusColor=status=>{switch(status){case'approved':return'success';case'rejected':return'error';case'pending_verification':return'warning';case'requires_review':return'info';default:return'default';}};const getProjectStatusIcon=status=>{switch(status){case'approved':return/*#__PURE__*/_jsx(CheckCircleIcon,{});case'rejected':return/*#__PURE__*/_jsx(WarningIcon,{});case'pending_verification':return/*#__PURE__*/_jsx(ScheduleIcon,{});case'requires_review':return/*#__PURE__*/_jsx(AssessmentIcon,{});default:return/*#__PURE__*/_jsx(ScheduleIcon,{});}};const recentActivities=[{icon:/*#__PURE__*/_jsx(PhotoIcon,{}),text:'New photos uploaded to Sundarbans project',time:'2 hours ago'},{icon:/*#__PURE__*/_jsx(LocationIcon,{}),text:'GPS waypoints recorded for Seagrass project',time:'1 day ago'},{icon:/*#__PURE__*/_jsx(CheckCircleIcon,{}),text:'Mangrove project approved by NCCR',time:'3 days ago'},{icon:/*#__PURE__*/_jsx(AssessmentIcon,{}),text:'AI verification completed',time:'5 days ago'}];if(loading){return/*#__PURE__*/_jsx(Box,{sx:{width:'100%',mt:2},children:/*#__PURE__*/_jsx(LinearProgress,{})});}return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(NatureIcon,{sx:{mr:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",sx:{flexGrow:1},children:\"Blue Carbon MRV - User Portal\"}),/*#__PURE__*/_jsx(IconButton,{size:\"large\",edge:\"end\",\"aria-label\":\"account\",\"aria-controls\":\"menu-appbar\",\"aria-haspopup\":\"true\",onClick:handleMenuOpen,color:\"inherit\",children:/*#__PURE__*/_jsx(AccountIcon,{})}),/*#__PURE__*/_jsxs(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,anchorOrigin:{vertical:'top',horizontal:'right'},keepMounted:true,transformOrigin:{vertical:'top',horizontal:'right'},open:Boolean(anchorEl),onClose:handleMenuClose,children:[/*#__PURE__*/_jsx(MenuItem,{onClick:()=>navigate('/user/projects'),children:\"My Projects\"}),/*#__PURE__*/_jsx(MenuItem,{onClick:handleLogout,children:\"Logout\"})]})]})}),/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsx(Paper,{elevation:3,sx:{p:3,mb:4,background:'linear-gradient(45deg, #e3f2fd, #f3e5f5)'},children:/*#__PURE__*/_jsxs(Grid,{container:true,alignItems:\"center\",spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Avatar,{sx:{width:60,height:60,bgcolor:'primary.main'},children:user===null||user===void 0?void 0:(_user$name=user.name)===null||_user$name===void 0?void 0:_user$name.charAt(0)})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:true,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",gutterBottom:true,children:[\"Welcome back, \",user===null||user===void 0?void 0:user.name,\"!\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",color:\"textSecondary\",children:[user===null||user===void 0?void 0:user.organization,\" \\u2022 Community Project Manager\"]}),/*#__PURE__*/_jsx(Chip,{label:\"\".concat(dashboardStats.total_projects,\" Active Projects\"),color:\"primary\",sx:{mt:1}})]}),/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"large\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>navigate('/user/projects/create'),sx:{mr:2},children:\"New Project\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"large\",startIcon:/*#__PURE__*/_jsx(ViewIcon,{}),onClick:()=>navigate('/user/projects'),children:\"View Projects\"})]})]})}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:4},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(NatureIcon,{sx:{fontSize:40,color:'primary.main',mb:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:dashboardStats.total_projects}),/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",children:\"Total Projects\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(CheckCircleIcon,{sx:{fontSize:40,color:'success.main',mb:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"success.main\",children:dashboardStats.approved_projects}),/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",children:\"Approved Projects\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(ScheduleIcon,{sx:{fontSize:40,color:'warning.main',mb:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"warning.main\",children:dashboardStats.pending_projects}),/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",children:\"Pending Review\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(TrendingUpIcon,{sx:{fontSize:40,color:'info.main',mb:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"info.main\",children:dashboardStats.total_credits}),/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",children:\"Carbon Credits\"})]})})})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:4,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDCCA Your Recent Projects\"}),userProjects.length===0?/*#__PURE__*/_jsxs(Alert,{severity:\"info\",children:[\"No projects found. \",/*#__PURE__*/_jsx(Button,{onClick:()=>navigate('/user/projects/create'),children:\"Create your first project\"})]}):/*#__PURE__*/_jsx(List,{children:userProjects.slice(0,5).map(project=>{var _project$status;return/*#__PURE__*/_jsxs(ListItem,{sx:{border:'1px solid #e0e0e0',borderRadius:2,mb:1,'&:hover':{bgcolor:'#f5f5f5'}},children:[/*#__PURE__*/_jsx(ListItemIcon,{children:getProjectStatusIcon(project.status)}),/*#__PURE__*/_jsx(ListItemText,{primary:project.project_name,secondary:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[project.ecosystem_type,\" \\u2022 \",project.area_hectares,\" hectares\"]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mt:1},children:[/*#__PURE__*/_jsx(Chip,{label:(_project$status=project.status)===null||_project$status===void 0?void 0:_project$status.replace('_',' ').toUpperCase(),color:getProjectStatusColor(project.status),size:\"small\"}),project.verification_score&&/*#__PURE__*/_jsx(Chip,{label:\"AI Score: \".concat(project.verification_score,\"/100\"),variant:\"outlined\",size:\"small\",sx:{ml:1}})]})]})}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>navigate('/user/projects'),children:\"View Details\"})]},project.id);})})]})})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:4,children:[/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDD14 Recent Activity\"}),/*#__PURE__*/_jsx(List,{dense:true,children:recentActivities.map((activity,index)=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:activity.icon}),/*#__PURE__*/_jsx(ListItemText,{primary:activity.text,secondary:activity.time})]},index))})]})}),/*#__PURE__*/_jsx(Card,{sx:{mt:2},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDE80 Quick Actions\"}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>navigate('/user/projects/create'),sx:{mb:2},children:\"Submit New Project\"}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(ViewIcon,{}),onClick:()=>navigate('/user/projects'),sx:{mb:2},children:\"View All Projects\"}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(PhotoIcon,{}),disabled:true,children:\"Upload Media (Coming Soon)\"})]})})]})]})]})]});};export default UserDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}