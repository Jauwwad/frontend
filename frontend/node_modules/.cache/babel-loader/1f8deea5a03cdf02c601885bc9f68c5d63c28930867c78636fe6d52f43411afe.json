{"ast":null,"code":"import _objectSpread from\"/Users/razashaikh/Desktop/sih/python-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Box,Container,Typography,Grid,Card,CardContent,Button,AppBar,Toolbar,IconButton,Menu,MenuItem,Chip,LinearProgress,Alert,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Dialog,DialogTitle,DialogContent,DialogActions,TextField,FormControl,InputLabel,Select,Fab}from'@mui/material';import{Nature as NatureIcon,AccountCircle as AccountIcon,Add as AddIcon,Visibility as ViewIcon,Edit as EditIcon,CheckCircle as CheckCircleIcon,Warning as WarningIcon,Schedule as ScheduleIcon,Assessment as AssessmentIcon,ArrowBack as ArrowBackIcon}from'@mui/icons-material';import{useAuth}from'../contexts/AuthContext';import{useSnackbar}from'notistack';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserProjects=()=>{var _selectedProject$stat;const navigate=useNavigate();const{user,logout}=useAuth();const{enqueueSnackbar}=useSnackbar();const[anchorEl,setAnchorEl]=useState(null);const[projects,setProjects]=useState([]);const[loading,setLoading]=useState(true);const[createDialogOpen,setCreateDialogOpen]=useState(false);const[selectedProject,setSelectedProject]=useState(null);const[viewDialogOpen,setViewDialogOpen]=useState(false);// New project form data\nconst[newProject,setNewProject]=useState({project_name:'',ecosystem_type:'mangrove',location:'',area_hectares:'',description:'',restoration_activities:'',expected_carbon_credits:''});useEffect(()=>{fetchProjects();},[]);const fetchProjects=async()=>{try{const response=await fetch('http://localhost:8002/api/projects');const data=await response.json();if(data.status==='success'){setProjects(data.projects||[]);}}catch(error){console.error('Error fetching projects:',error);enqueueSnackbar('Failed to load projects',{variant:'error'});}finally{setLoading(false);}};const handleMenuOpen=event=>{setAnchorEl(event.currentTarget);};const handleMenuClose=()=>{setAnchorEl(null);};const handleLogout=()=>{logout();navigate('/');enqueueSnackbar('Logged out successfully',{variant:'success'});};const handleCreateProject=async()=>{try{const response=await fetch('http://localhost:8002/api/projects',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(_objectSpread(_objectSpread({},newProject),{},{area_hectares:parseFloat(newProject.area_hectares),expected_carbon_credits:parseFloat(newProject.expected_carbon_credits),submitted_by:(user===null||user===void 0?void 0:user.email)||'demo_user',submission_date:new Date().toISOString().split('T')[0]}))});const data=await response.json();if(data.status==='success'){enqueueSnackbar('Project submitted successfully!',{variant:'success'});setCreateDialogOpen(false);setNewProject({project_name:'',ecosystem_type:'mangrove',location:'',area_hectares:'',description:'',restoration_activities:'',expected_carbon_credits:''});fetchProjects();// Refresh the projects list\n}else{enqueueSnackbar(data.message||'Failed to submit project',{variant:'error'});}}catch(error){console.error('Error creating project:',error);enqueueSnackbar('Failed to submit project',{variant:'error'});}};const handleViewProject=project=>{setSelectedProject(project);setViewDialogOpen(true);};const getProjectStatusColor=status=>{switch(status){case'approved':return'success';case'rejected':return'error';case'pending_verification':return'warning';case'requires_review':return'info';default:return'default';}};const getProjectStatusIcon=status=>{switch(status){case'approved':return/*#__PURE__*/_jsx(CheckCircleIcon,{});case'rejected':return/*#__PURE__*/_jsx(WarningIcon,{});case'pending_verification':return/*#__PURE__*/_jsx(ScheduleIcon,{});case'requires_review':return/*#__PURE__*/_jsx(AssessmentIcon,{});default:return/*#__PURE__*/_jsx(ScheduleIcon,{});}};if(loading){return/*#__PURE__*/_jsx(Box,{sx:{width:'100%',mt:2},children:/*#__PURE__*/_jsx(LinearProgress,{})});}return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(IconButton,{edge:\"start\",color:\"inherit\",onClick:()=>navigate('/user'),sx:{mr:2},children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(NatureIcon,{sx:{mr:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",sx:{flexGrow:1},children:\"My Projects\"}),/*#__PURE__*/_jsx(IconButton,{size:\"large\",edge:\"end\",\"aria-label\":\"account\",onClick:handleMenuOpen,color:\"inherit\",children:/*#__PURE__*/_jsx(AccountIcon,{})}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorEl,open:Boolean(anchorEl),onClose:handleMenuClose,children:[/*#__PURE__*/_jsx(MenuItem,{onClick:()=>navigate('/user'),children:\"Dashboard\"}),/*#__PURE__*/_jsx(MenuItem,{onClick:handleLogout,children:\"Logout\"})]})]})}),/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsx(Paper,{elevation:3,sx:{p:3,mb:4},children:/*#__PURE__*/_jsxs(Grid,{container:true,justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"\\uD83C\\uDF3F Blue Carbon Projects\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",color:\"textSecondary\",children:\"Manage your restoration projects and track their progress\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"large\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>setCreateDialogOpen(true),children:\"Submit New Project\"})})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDCCA Your Project Portfolio\"}),projects.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mt:2},children:\"No projects found. Submit your first blue carbon restoration project!\"}):/*#__PURE__*/_jsx(TableContainer,{component:Paper,elevation:0,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Project Name\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Ecosystem\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Location\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Area (ha)\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Status\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Carbon Credits\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Actions\"})})]})}),/*#__PURE__*/_jsx(TableBody,{children:projects.map(project=>{var _project$status;return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:project.project_name})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:project.ecosystem_type,variant:\"outlined\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:project.location}),/*#__PURE__*/_jsx(TableCell,{children:project.area_hectares}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{icon:getProjectStatusIcon(project.status),label:(_project$status=project.status)===null||_project$status===void 0?void 0:_project$status.replace('_',' ').toUpperCase(),color:getProjectStatusColor(project.status),size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"primary\",children:[project.carbon_credits||project.expected_carbon_credits||0,\" tCO\\u2082\"]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(ViewIcon,{}),onClick:()=>handleViewProject(project),children:\"View\"})})]},project.id);})})]})})]})})]}),/*#__PURE__*/_jsx(Fab,{color:\"primary\",\"aria-label\":\"add\",sx:{position:'fixed',bottom:16,right:16},onClick:()=>setCreateDialogOpen(true),children:/*#__PURE__*/_jsx(AddIcon,{})}),/*#__PURE__*/_jsxs(Dialog,{open:createDialogOpen,onClose:()=>setCreateDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"\\uD83C\\uDF31 Submit New Blue Carbon Project\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Project Name\",value:newProject.project_name,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{project_name:e.target.value})),required:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Ecosystem Type\"}),/*#__PURE__*/_jsxs(Select,{value:newProject.ecosystem_type,label:\"Ecosystem Type\",onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{ecosystem_type:e.target.value})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"mangrove\",children:\"Mangrove\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"seagrass\",children:\"Seagrass\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"saltmarsh\",children:\"Salt Marsh\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"coastal_wetland\",children:\"Coastal Wetland\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Location\",value:newProject.location,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{location:e.target.value})),required:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Area (Hectares)\",type:\"number\",value:newProject.area_hectares,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{area_hectares:e.target.value})),required:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Expected Carbon Credits (tCO\\u2082)\",type:\"number\",value:newProject.expected_carbon_credits,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{expected_carbon_credits:e.target.value}))})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Project Description\",multiline:true,rows:3,value:newProject.description,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{description:e.target.value})),required:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Restoration Activities\",multiline:true,rows:2,value:newProject.restoration_activities,onChange:e=>setNewProject(_objectSpread(_objectSpread({},newProject),{},{restoration_activities:e.target.value})),helperText:\"Describe the specific restoration activities planned\"})})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setCreateDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateProject,variant:\"contained\",disabled:!newProject.project_name||!newProject.location||!newProject.area_hectares,children:\"Submit Project\"})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:viewDialogOpen,onClose:()=>setViewDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"\\uD83C\\uDF3F Project Details\"}),/*#__PURE__*/_jsx(DialogContent,{children:selectedProject&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mt:1},children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:selectedProject.project_name}),/*#__PURE__*/_jsx(Chip,{icon:getProjectStatusIcon(selectedProject.status),label:(_selectedProject$stat=selectedProject.status)===null||_selectedProject$stat===void 0?void 0:_selectedProject$stat.replace('_',' ').toUpperCase(),color:getProjectStatusColor(selectedProject.status)})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Ecosystem Type\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedProject.ecosystem_type})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Location\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedProject.location})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Area\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",children:[selectedProject.area_hectares,\" hectares\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Carbon Credits\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",color:\"primary\",children:[selectedProject.carbon_credits||selectedProject.expected_carbon_credits||0,\" tCO\\u2082\"]})]}),selectedProject.verification_score&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"AI Verification Score\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",children:[selectedProject.verification_score,\"/100\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Description\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedProject.description})]}),selectedProject.restoration_activities&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"textSecondary\",children:\"Restoration Activities\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedProject.restoration_activities})]})]})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>setViewDialogOpen(false),children:\"Close\"})})]})]});};export default UserProjects;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}