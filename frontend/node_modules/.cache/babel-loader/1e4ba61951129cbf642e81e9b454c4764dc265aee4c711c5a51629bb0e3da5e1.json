{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Box,Card,CardContent,Typography,Button,Grid,Alert,Chip,Dialog,DialogTitle,DialogContent,DialogActions,TextField}from'@mui/material';import{ShoppingCart,Sell}from'@mui/icons-material';import{marketplaceAPI,handleAPIError}from'../services/api';import{useSnackbar}from'notistack';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Marketplace=()=>{const{enqueueSnackbar}=useSnackbar();const[listings,setListings]=useState([]);const[purchaseDialog,setPurchaseDialog]=useState(false);const[selectedListing,setSelectedListing]=useState(null);const[quantity,setQuantity]=useState('');useEffect(()=>{loadListings();},[]);const loadListings=async()=>{try{const result=await marketplaceAPI.getListings();setListings(result.listings||[]);}catch(error){const errorInfo=handleAPIError(error);enqueueSnackbar(errorInfo.message,{variant:'error'});}};const handlePurchase=async()=>{try{await marketplaceAPI.purchaseCredits(selectedListing.listing_id,parseFloat(quantity));enqueueSnackbar('Carbon credits purchased successfully!',{variant:'success'});setPurchaseDialog(false);setQuantity('');loadListings();}catch(error){const errorInfo=handleAPIError(error);enqueueSnackbar(errorInfo.message,{variant:'error'});}};return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Carbon Credit Marketplace\"}),/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mb:3},children:\"Trade verified blue carbon credits from restoration projects\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:listings.length===0?/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center',py:6},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"textSecondary\",gutterBottom:true,children:\"No carbon credits available\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:\"Check back later for verified carbon credits from blue carbon projects\"})]})})}):listings.map(listing=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,lg:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"flex-start\",mb:2,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[listing.credit_amount,\" Credits\"]}),/*#__PURE__*/_jsx(Chip,{label:listing.status,color:\"primary\",size:\"small\"})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",color:\"primary\",gutterBottom:true,children:[listing.price_per_credit,\" MATIC\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",display:\"block\",children:\"per credit\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:2,mb:2},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Project:\"}),\" \",listing.project_id]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mb:2},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Value:\"}),\" \",listing.total_value,\" MATIC\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mb:2},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Certification:\"}),\" \",listing.certification_level||'Verified']}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:3},children:listing.description}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",startIcon:/*#__PURE__*/_jsx(ShoppingCart,{}),onClick:()=>{setSelectedListing(listing);setPurchaseDialog(true);},children:\"Purchase Credits\"})]})})},listing.listing_id))}),/*#__PURE__*/_jsxs(Dialog,{open:purchaseDialog,onClose:()=>setPurchaseDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Purchase Carbon Credits\"}),/*#__PURE__*/_jsx(DialogContent,{children:selectedListing&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Available Credits:\"}),\" \",selectedListing.credit_amount]}),/*#__PURE__*/_jsxs(Typography,{gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price per Credit:\"}),\" \",selectedListing.price_per_credit,\" MATIC\"]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,type:\"number\",label:\"Quantity to Purchase\",value:quantity,onChange:e=>setQuantity(e.target.value),sx:{mt:2,mb:2},inputProps:{min:0.1,max:selectedListing.credit_amount,step:0.1}}),quantity&&/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"primary\",children:[\"Total: \",(parseFloat(quantity)*selectedListing.price_per_credit).toFixed(2),\" MATIC\"]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setPurchaseDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handlePurchase,disabled:!quantity||parseFloat(quantity)<=0,children:\"Purchase\"})]})]})]});};export default Marketplace;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}