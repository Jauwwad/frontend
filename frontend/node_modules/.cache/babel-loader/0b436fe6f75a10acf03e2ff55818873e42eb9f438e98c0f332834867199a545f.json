{"ast":null,"code":"import React,{useState}from'react';import{Card,CardContent,Typography,Button,Box,Chip,Alert,Dialog,DialogTitle,DialogContent,DialogActions,List,ListItem,ListItemText,IconButton,Tooltip,Grid,CircularProgress,LinearProgress,Divider}from'@mui/material';import{AccountBalanceWallet,Link as LinkIcon,LinkOff,Refresh,Info,ContentCopy,OpenInNew,CheckCircle,Pending,Error,Analytics,Storage,Speed,EmojiEvents,Warning,Nature}from'@mui/icons-material';import{useBlockchain}from'../contexts/BlockchainContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BlockchainStatus=_ref=>{var _aiAnalysis$ecosystem,_projectData$blockcha;let{projectData,aiAnalysis,blockchainData}=_ref;const{isConnected,account,networkInfo,carbonBalance,contractAddresses,hasMetaMask,loading,error,canConnect,needsMetaMask,initializeBlockchain,disconnect,refreshUserData,formatAddress}=useBlockchain();const[showDetails,setShowDetails]=useState(false);const[refreshing,setRefreshing]=useState(false);// Handle connect button click\nconst handleConnect=async()=>{await initializeBlockchain();};// Handle refresh\nconst handleRefresh=async()=>{setRefreshing(true);await refreshUserData();setRefreshing(false);};// Copy to clipboard\nconst copyToClipboard=text=>{navigator.clipboard.writeText(text);};// Open in block explorer\nconst openInExplorer=address=>{window.open(\"https://amoy.polygonscan.com/address/\".concat(address),'_blank');};const getStatusColor=score=>{if(score>=85)return'success';if(score>=70)return'warning';if(score>=55)return'info';return'error';};const getStatusIcon=status=>{switch(status){case'approved':return/*#__PURE__*/_jsx(CheckCircle,{color:\"success\"});case'requires_review':return/*#__PURE__*/_jsx(Pending,{color:\"warning\"});case'needs_improvement':return/*#__PURE__*/_jsx(Error,{color:\"error\"});default:return/*#__PURE__*/_jsx(Pending,{color:\"info\"});}};const getCategoryDescription=category=>{switch(category){case'excellent':return'Outstanding project quality with comprehensive data';case'good':return'Good project quality meeting all requirements';case'acceptable':return'Acceptable project quality with minor improvements needed';case'poor':return'Project quality needs significant improvement';default:return'Project quality assessment pending';}};// Render MetaMask installation prompt\nif(needsMetaMask){return/*#__PURE__*/_jsx(Card,{sx:{mb:2},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83E\\uDD8A MetaMask Required\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"MetaMask is required for blockchain features. Please install MetaMask browser extension.\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",href:\"https://metamask.io/download/\",target:\"_blank\",startIcon:/*#__PURE__*/_jsx(OpenInNew,{}),children:\"Install MetaMask\"})]})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Card,{sx:{mb:2},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:8,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(AccountBalanceWallet,{color:isConnected?\"success\":\"disabled\"}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",children:\"Blockchain Wallet\"}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,children:[loading?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(Chip,{label:isConnected?\"Connected\":\"Disconnected\",color:isConnected?\"success\":\"default\",size:\"small\",icon:isConnected?/*#__PURE__*/_jsx(LinkIcon,{}):/*#__PURE__*/_jsx(LinkOff,{})}),isConnected&&account&&/*#__PURE__*/_jsx(Chip,{label:formatAddress(account),size:\"small\",variant:\"outlined\",onClick:()=>copyToClipboard(account),clickable:true})]})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:1,justifyContent:\"flex-end\",flexWrap:\"wrap\",children:[canConnect&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleConnect,disabled:loading,size:\"small\",children:\"Connect Wallet\"}),isConnected&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Refresh Data\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handleRefresh,disabled:refreshing,size:\"small\",children:refreshing?/*#__PURE__*/_jsx(CircularProgress,{size:20}):/*#__PURE__*/_jsx(Refresh,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"View Details\",children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowDetails(true),size:\"small\",children:/*#__PURE__*/_jsx(Info,{})})}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:disconnect,size:\"small\",children:\"Disconnect\"})]})]})})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mt:2},children:error}),isConnected&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:carbonBalance}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Carbon Credits\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"secondary\",children:(networkInfo===null||networkInfo===void 0?void 0:networkInfo.chainId)||'Unknown'}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Chain ID\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:(networkInfo===null||networkInfo===void 0?void 0:networkInfo.blockNumber)||'Unknown'}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Block Number\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:(networkInfo===null||networkInfo===void 0?void 0:networkInfo.gasPrice)||'Unknown'}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Gas Price\"})]})})]})]})}),projectData&&/*#__PURE__*/_jsx(Card,{elevation:3,children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDD17 Project Blockchain Status\"}),/*#__PURE__*/_jsx(Box,{mb:3,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,children:getStatusIcon(projectData.current_status)}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:true,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Project ID: \",projectData.project_id]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"Status: \",projectData.current_status.replace('_',' ').toUpperCase()]})]}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Chip,{label:\"\".concat(projectData.verification_score,\"/100\"),color:getStatusColor(projectData.verification_score),variant:\"outlined\"})})]})}),/*#__PURE__*/_jsx(Divider,{}),aiAnalysis&&/*#__PURE__*/_jsxs(Box,{mt:3,mb:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83E\\uDD16 AI Verification Analysis\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:1,children:[/*#__PURE__*/_jsx(Analytics,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",ml:1,children:\"Overall Score\"})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",color:getStatusColor(aiAnalysis.overall_score),children:[aiAnalysis.overall_score,\"/100\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"Category: \",aiAnalysis.category||'Unknown']}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:getCategoryDescription(aiAnalysis.category)})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Detailed Scores\"}),aiAnalysis.detailed_scores&&Object.entries(aiAnalysis.detailed_scores).map(_ref2=>{let[key,scoreData]=_ref2;return/*#__PURE__*/_jsxs(Box,{mb:1,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:key.replace('_',' ').replace(/\\b\\w/g,l=>l.toUpperCase())}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",fontWeight:\"bold\",children:[typeof scoreData==='object'?scoreData.score:scoreData,\"/100\"]})]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:typeof scoreData==='object'?scoreData.score:scoreData,color:getStatusColor(typeof scoreData==='object'?scoreData.score:scoreData)})]},key);})]})})})]}),aiAnalysis.ecosystem_assessment&&/*#__PURE__*/_jsx(Box,{mt:2,children:/*#__PURE__*/_jsxs(Alert,{severity:\"info\",icon:/*#__PURE__*/_jsx(Nature,{}),children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",gutterBottom:true,children:[\"Ecosystem Assessment: \",aiAnalysis.ecosystem_assessment.ecosystem_type]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"Location Suitable: \",aiAnalysis.ecosystem_assessment.location_suitable?'Yes':'No',\" | Expected Carbon Range: \",(_aiAnalysis$ecosystem=aiAnalysis.ecosystem_assessment.expected_carbon_range)===null||_aiAnalysis$ecosystem===void 0?void 0:_aiAnalysis$ecosystem.join('-'),\" tCO2/ha/year\"]})]})}),aiAnalysis.recommendations&&aiAnalysis.recommendations.length>0&&/*#__PURE__*/_jsx(Box,{mt:2,children:/*#__PURE__*/_jsxs(Alert,{severity:\"info\",icon:/*#__PURE__*/_jsx(Info,{}),children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"Recommendations:\"}),/*#__PURE__*/_jsx(List,{dense:true,children:aiAnalysis.recommendations.map((rec,index)=>/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:rec})},index))})]})}),aiAnalysis.warnings&&aiAnalysis.warnings.length>0&&/*#__PURE__*/_jsx(Box,{mt:2,children:/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",icon:/*#__PURE__*/_jsx(Warning,{}),children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"Warnings:\"}),/*#__PURE__*/_jsx(List,{dense:true,children:aiAnalysis.warnings.map((warning,index)=>/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:warning})},index))})]})})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Box,{mt:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\u26D3\\uFE0F Blockchain Registration\"}),blockchainData&&blockchainData.registered?/*#__PURE__*/_jsxs(Alert,{severity:\"success\",icon:/*#__PURE__*/_jsx(CheckCircle,{}),children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"Successfully Registered on Polygon Amoy Testnet\"}),/*#__PURE__*/_jsxs(Box,{mt:1,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Blockchain ID:\"}),\" \",blockchainData.blockchain_id]}),blockchainData.tx_hash&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Transaction Hash:\"}),/*#__PURE__*/_jsx(Box,{component:\"span\",sx:{wordBreak:'break-all',ml:1},children:blockchainData.tx_hash})]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Your project data is now permanently stored on the blockchain\"})]})]}):/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",icon:/*#__PURE__*/_jsx(Pending,{}),children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:\"Blockchain Registration Pending\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"Projects with scores \\u226570 are automatically registered on blockchain.\",projectData.verification_score<70&&' Improve your project quality to enable blockchain registration.']})]})]}),/*#__PURE__*/_jsx(Box,{mt:3,children:/*#__PURE__*/_jsxs(Alert,{severity:\"info\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"\\uD83C\\uDFAF Performance Overview\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Storage,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:\"IPFS Storage\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"bold\",children:(_projectData$blockcha=projectData.blockchain)!==null&&_projectData$blockcha!==void 0&&_projectData$blockcha.registered?'Active':'Pending'})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(AccountBalanceWallet,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:\"Blockchain\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"bold\",children:blockchainData!==null&&blockchainData!==void 0&&blockchainData.registered?'Registered':'Pending'})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(Analytics,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:\"AI Score\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"bold\",children:(aiAnalysis===null||aiAnalysis===void 0?void 0:aiAnalysis.category)||'Pending'})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",children:[/*#__PURE__*/_jsx(EmojiEvents,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:\"Status\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"bold\",children:projectData.current_status.replace('_',' ')})]})})]})]})})]})}),/*#__PURE__*/_jsxs(Dialog,{open:showDetails,onClose:()=>setShowDetails(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"\\uD83D\\uDD17 Blockchain Connection Details\"}),/*#__PURE__*/_jsx(DialogContent,{children:isConnected?/*#__PURE__*/_jsxs(List,{children:[/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Wallet Address\",secondary:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace'},children:account}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>copyToClipboard(account),children:/*#__PURE__*/_jsx(ContentCopy,{fontSize:\"small\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>openInExplorer(account),children:/*#__PURE__*/_jsx(OpenInNew,{fontSize:\"small\"})})]})})}),/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Network\",secondary:\"Polygon Amoy Testnet (Chain ID: \".concat(networkInfo===null||networkInfo===void 0?void 0:networkInfo.chainId,\")\")})}),/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Carbon Credit Balance\",secondary:\"\".concat(carbonBalance,\" Credits\")})}),/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Contract Addresses\",secondary:/*#__PURE__*/_jsx(Box,{sx:{mt:1},children:Object.entries(contractAddresses).map(_ref3=>{let[name,address]=_ref3;return/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,sx:{mb:1},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",sx:{minWidth:120},children:[name,\":\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontFamily:'monospace',fontSize:'0.7rem'},children:address}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>copyToClipboard(address),children:/*#__PURE__*/_jsx(ContentCopy,{fontSize:\"small\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>openInExplorer(address),children:/*#__PURE__*/_jsx(OpenInNew,{fontSize:\"small\"})})]},name);})})})})]}):/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"Connect your wallet to view blockchain details.\"})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>setShowDetails(false),children:\"Close\"})})]})]});};export default BlockchainStatus;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}