{"ast":null,"code":"import _objectSpread from\"/Users/razashaikh/Desktop/sih/python-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Box,Card,CardContent,Typography,Button,Grid,Alert,Chip,Dialog,DialogTitle,DialogContent,DialogActions,TextField,Container,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,Select,MenuItem,FormControl,InputLabel,CircularProgress,Tabs,Tab,Badge,LinearProgress,Accordion,AccordionSummary,AccordionDetails,List,ListItem,ListItemText,ListItemIcon,IconButton,Tooltip}from'@mui/material';// Import Leaflet components\nimport{MapContainer,TileLayer,Marker,Popup,useMap}from'react-leaflet';import L from'leaflet';import'leaflet/dist/leaflet.css';import{CheckCircle,Cancel,Dashboard as DashboardIcon,VerifiedUser as VerifiedIcon,Warning as WarningIcon,CheckCircle as ApprovedIcon,Schedule as PendingIcon,Cancel as RejectedIcon,Visibility as ViewIcon,Edit as EditIcon,Security as SecurityIcon,Analytics as AnalyticsIcon,Map as MapIcon,ExpandMore as ExpandMoreIcon,Refresh as RefreshIcon,Download as DownloadIcon,Share as ShareIcon,Logout as LogoutIcon}from'@mui/icons-material';import{adminAPI,handleAPIError}from'../services/api';import{useSnackbar}from'notistack';// Fix for Leaflet marker icons in React\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',iconUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',shadowUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'});// Custom markers for different project statuses\nconst getMarkerColor=status=>{switch(status){case'approved':return'#4caf50';// Green\ncase'requires_review':return'#f44336';// Red\ncase'pending_verification':return'#ff9800';// Orange\ncase'submitted':return'#2196f3';// Blue\ndefault:return'#9e9e9e';// Grey\n}};// Custom marker icon based on status\nconst createCustomIcon=status=>{const color=getMarkerColor(status);return L.divIcon({className:'custom-marker',html:\"<div style=\\\"\\n      background-color: \".concat(color,\"; \\n      width: 25px; \\n      height: 25px; \\n      border-radius: 50%; \\n      border: 3px solid white; \\n      box-shadow: 0 2px 4px rgba(0,0,0,0.3);\\n      position: relative;\\n    \\\"></div>\"),iconSize:[25,25],iconAnchor:[12.5,12.5],popupAnchor:[0,-12.5]});};const AdminDashboard=()=>{var _selectedProject$medi,_selectedProject$medi2,_selectedProject$medi3,_selectedProject$medi4;const{enqueueSnackbar}=useSnackbar();const navigate=useNavigate();const[activeTab,setActiveTab]=useState(0);const[loading,setLoading]=useState(false);const[refreshing,setRefreshing]=useState(false);// Data states\nconst[dashboardData,setDashboardData]=useState(null);const[projects,setProjects]=useState([]);const[selectedProject,setSelectedProject]=useState(null);// eslint-disable-next-line no-unused-vars\nconst[adminStats,setAdminStats]=useState({total_projects:0,pending_review:0,ai_flagged:0,approved:0,rejected:0,total_credits:0,total_revenue:0});// Dialog states\nconst[reviewDialog,setReviewDialog]=useState(false);const[detailsDialog,setDetailsDialog]=useState(false);// eslint-disable-next-line no-unused-vars\nconst[aiAnalysisDialog,setAiAnalysisDialog]=useState(false);// Review form state\nconst[reviewComments,setReviewComments]=useState('');const[reviewData,setReviewData]=useState({decision:'',comments:'',credits_awarded:'',compliance_notes:''});// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(()=>{loadDashboard();fetchAdminData();},[]);const loadDashboard=async()=>{try{const result=await adminAPI.getDashboard();setDashboardData(result);}catch(error){const errorInfo=handleAPIError(error);enqueueSnackbar(errorInfo.message,{variant:'error'});}};const fetchAdminData=async()=>{setRefreshing(true);try{// Fetch projects from Python backend\nconst projectsResponse=await fetch('http://localhost:8002/api/projects');const projectsData=await projectsResponse.json();// Fetch admin statistics  \nconst adminResponse=await fetch('http://localhost:8002/api/admin/dashboard');const adminData=await adminResponse.json();setProjects(projectsData.projects||[]);setAdminStats(adminData||{});}catch(error){console.error('Error fetching admin data:',error);enqueueSnackbar('Failed to fetch admin data',{variant:'error'});}finally{setRefreshing(false);}};const handleReview=async action=>{try{await adminAPI.reviewProject(selectedProject.id,action,reviewComments);enqueueSnackbar(\"Project \".concat(action,\"d successfully\"),{variant:'success'});setReviewDialog(false);setReviewComments('');loadDashboard();fetchAdminData();}catch(error){const errorInfo=handleAPIError(error);enqueueSnackbar(errorInfo.message,{variant:'error'});}};const handleProjectReview=async(projectId,decision)=>{setLoading(true);try{const response=await fetch(\"http://localhost:8002/api/admin/projects/\".concat(projectId,\"/review\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(_objectSpread(_objectSpread({decision},reviewData),{},{reviewer_id:'admin_user',review_timestamp:new Date().toISOString()}))});if(response.ok){enqueueSnackbar(\"Project \".concat(decision,\" successfully\"),{variant:'success'});fetchAdminData();// Refresh data\nsetReviewDialog(false);setReviewData({decision:'',comments:'',credits_awarded:'',compliance_notes:''});}else{throw new Error('Review submission failed');}}catch(error){console.error('Error submitting review:',error);enqueueSnackbar('Failed to submit review',{variant:'error'});}finally{setLoading(false);}};const handleLogout=()=>{// Clear localStorage\nlocalStorage.removeItem('userInfo');localStorage.removeItem('auth_token');// Navigate to login\nnavigate('/login');};const getStatusColor=status=>{switch(status){case'approved':return'success';case'rejected':return'error';case'pending_verification':return'warning';case'requires_review':return'info';case'under_review':return'primary';default:return'default';}};const getStatusIcon=status=>{switch(status){case'approved':return/*#__PURE__*/_jsx(ApprovedIcon,{});case'rejected':return/*#__PURE__*/_jsx(RejectedIcon,{});case'pending_verification':return/*#__PURE__*/_jsx(PendingIcon,{});case'requires_review':return/*#__PURE__*/_jsx(WarningIcon,{});case'under_review':return/*#__PURE__*/_jsx(VerifiedIcon,{});default:return/*#__PURE__*/_jsx(PendingIcon,{});}};const renderDashboardTab=()=>{var _dashboardData$statis,_dashboardData$statis2,_dashboardData$statis3;return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"\\uD83C\\uDFDB\\uFE0F NCCR Admin Dashboard\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"error\",startIcon:/*#__PURE__*/_jsx(LogoutIcon,{}),onClick:handleLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:4},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(DashboardIcon,{color:\"primary\",sx:{mr:2,fontSize:40}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",gutterBottom:true,children:\"Total Projects\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:(dashboardData===null||dashboardData===void 0?void 0:(_dashboardData$statis=dashboardData.statistics)===null||_dashboardData$statis===void 0?void 0:_dashboardData$statis.total_projects)||projects.length||0})]})]})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(PendingIcon,{color:\"warning\",sx:{mr:2,fontSize:40}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",gutterBottom:true,children:\"Pending Review\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:(dashboardData===null||dashboardData===void 0?void 0:(_dashboardData$statis2=dashboardData.statistics)===null||_dashboardData$statis2===void 0?void 0:_dashboardData$statis2.pending_review)||projects.filter(p=>p.status==='pending_verification'||p.status==='requires_review').length||0})]})]})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(ApprovedIcon,{color:\"success\",sx:{mr:2,fontSize:40}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",gutterBottom:true,children:\"Approved\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:(dashboardData===null||dashboardData===void 0?void 0:(_dashboardData$statis3=dashboardData.statistics)===null||_dashboardData$statis3===void 0?void 0:_dashboardData$statis3.approved)||projects.filter(p=>p.status==='approved').length||0})]})]})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(WarningIcon,{color:\"error\",sx:{mr:2,fontSize:40}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",gutterBottom:true,children:\"AI Flagged\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:projects.filter(p=>p.verification_score<60).length||0})]})]})})})})]}),/*#__PURE__*/_jsx(Card,{sx:{mb:3},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83E\\uDD16 Recent AI Verification Alerts\"}),/*#__PURE__*/_jsxs(List,{children:[projects.filter(p=>p.verification_score<70).slice(0,5).map(project=>{var _project$ai_verificat,_project$ai_verificat2;return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(WarningIcon,{color:\"warning\"})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\".concat(project.project_name,\" - Score: \").concat(project.verification_score||0,\"/100\"),secondary:\"Flagged: \".concat(((_project$ai_verificat=project.ai_verification)===null||_project$ai_verificat===void 0?void 0:(_project$ai_verificat2=_project$ai_verificat.flags)===null||_project$ai_verificat2===void 0?void 0:_project$ai_verificat2.join(', '))||'Low verification score')}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",onClick:()=>{setSelectedProject(project);setDetailsDialog(true);},children:\"Review\"})]},project.id);}),projects.filter(p=>p.verification_score<70).length===0&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:\"No AI verification alerts at this time\"})]})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDD27 System Status\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:\"Python Backend: Online (Port 8002)\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:\"AI Verification: Operational\"})})]})]})})]});};const renderProjectsTab=()=>{var _dashboardData$pendin;return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"\\uD83D\\uDD0D Project Management & Review\"}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(RefreshIcon,{}),onClick:()=>{loadDashboard();fetchAdminData();},disabled:refreshing,sx:{mr:2},children:refreshing?'Refreshing...':'Refresh'}),/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(DownloadIcon,{}),variant:\"outlined\",children:\"Export Data\"})]})]}),/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Project ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Ecosystem\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Area (ha)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"AI Score\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Submitted\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:(projects.length>0?projects:(dashboardData===null||dashboardData===void 0?void 0:dashboardData.pending_projects)||[]).map(project=>{var _project$status;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:project.id}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"bold\",children:project.project_name}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"textSecondary\",children:[\"by \",project.created_by]})]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:project.ecosystem_type,size:\"small\",color:\"primary\",variant:\"outlined\"})}),/*#__PURE__*/_jsx(TableCell,{children:project.area_hectares}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mr:1},children:[project.verification_score||0,\"/100\"]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:project.verification_score||0,sx:{width:60,height:6},color:project.verification_score>=80?'success':project.verification_score>=60?'warning':'error'})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{icon:getStatusIcon(project.status),label:(_project$status=project.status)===null||_project$status===void 0?void 0:_project$status.replace('_',' ').toUpperCase(),color:getStatusColor(project.status),size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:new Date(project.created_at).toLocaleDateString()}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"View Details\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>{setSelectedProject(project);setDetailsDialog(true);},children:/*#__PURE__*/_jsx(ViewIcon,{})})}),(project.status==='pending_verification'||project.status==='requires_review'||!project.status)&&/*#__PURE__*/_jsx(Tooltip,{title:\"Review Project\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:\"primary\",onClick:()=>{setSelectedProject(project);setReviewDialog(true);},children:/*#__PURE__*/_jsx(EditIcon,{})})}),project.ai_verification&&/*#__PURE__*/_jsx(Tooltip,{title:\"AI Analysis\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:\"secondary\",onClick:()=>{setSelectedProject(project);setAiAnalysisDialog(true);},children:/*#__PURE__*/_jsx(SecurityIcon,{})})})]})]},project.id);})})]})}),(dashboardData===null||dashboardData===void 0?void 0:(_dashboardData$pendin=dashboardData.pending_projects)===null||_dashboardData$pendin===void 0?void 0:_dashboardData$pendin.length)>0&&/*#__PURE__*/_jsxs(Box,{sx:{mt:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Legacy Projects Pending Review\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:dashboardData.pending_projects.map(project=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{variant:\"outlined\",children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:project.project_name}),/*#__PURE__*/_jsxs(Typography,{color:\"textSecondary\",children:[project.ecosystem_type,\" \\u2022 \",project.area_hectares,\" hectares\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Created: \",new Date(project.created_at).toLocaleDateString()]})]}),/*#__PURE__*/_jsx(Box,{display:\"flex\",gap:1,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",startIcon:/*#__PURE__*/_jsx(CheckCircle,{}),onClick:()=>{setSelectedProject(project);setReviewDialog(true);},children:\"Review\"})})]})})})},project.id))})]})]});};const renderAnalyticsTab=()=>/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"\\uD83D\\uDCCA Analytics & Reports\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDCC8 Carbon Credits Overview\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h3\",color:\"primary\",children:projects.reduce((sum,p)=>sum+(p.carbon_credits||0),0)}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:\"Total tCO\\u2082 Credits Issued\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83C\\uDF3F Ecosystem Breakdown\"}),['mangrove','seagrass','salt_marsh','coastal_wetland'].map(ecosystem=>{const count=projects.filter(p=>p.ecosystem_type===ecosystem).length;const percentage=projects.length>0?count/projects.length*100:0;return/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:ecosystem.replace('_',' ').toUpperCase()}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:count})]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:percentage,sx:{height:8,borderRadius:4}})]},ecosystem);})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDCCA Project Status Distribution\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:['approved','pending_verification','requires_review','rejected'].map(status=>{const count=projects.filter(p=>p.status===status).length;return/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsx(Card,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:getStatusColor(status)+'.main',children:count}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:status.replace('_',' ').toUpperCase()})]})})},status);})})]})})})]})]});const renderMapTab=()=>/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDDFA\\uFE0F Project Locations Map\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",gutterBottom:true,children:\"View all blue carbon restoration projects on an interactive map\"}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,display:'flex',gap:2,flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Box,{sx:{width:16,height:16,backgroundColor:'#4caf50',borderRadius:'50%'}}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Approved\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Box,{sx:{width:16,height:16,backgroundColor:'#f44336',borderRadius:'50%'}}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Requires Review\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Box,{sx:{width:16,height:16,backgroundColor:'#ff9800',borderRadius:'50%'}}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Pending Verification\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Box,{sx:{width:16,height:16,backgroundColor:'#2196f3',borderRadius:'50%'}}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Submitted\"})]})]}),/*#__PURE__*/_jsx(Box,{sx:{height:'600px',width:'100%',border:'1px solid #ddd',borderRadius:1},children:/*#__PURE__*/_jsxs(MapContainer,{center:[20.5937,78.9629]// Center of India\n,zoom:5,style:{height:'100%',width:'100%'},children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"}),projects.map(project=>{if(project.location&&project.location.lat&&project.location.lng){var _project$ecosystem_ty,_project$status2;return/*#__PURE__*/_jsx(Marker,{position:[project.location.lat,project.location.lng],icon:createCustomIcon(project.status),children:/*#__PURE__*/_jsx(Popup,{children:/*#__PURE__*/_jsxs(Box,{sx:{minWidth:250},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:project.project_name}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",project.id]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Type:\"}),\" \",((_project$ecosystem_ty=project.ecosystem_type)===null||_project$ecosystem_ty===void 0?void 0:_project$ecosystem_ty.replace('_',' '))||'N/A']}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Area:\"}),\" \",project.area_hectares,\" hectares\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),/*#__PURE__*/_jsx(Chip,{label:((_project$status2=project.status)===null||_project$status2===void 0?void 0:_project$status2.replace('_',' ').toUpperCase())||'UNKNOWN',color:getStatusColor(project.status),size:\"small\",sx:{ml:1}})]}),project.location.address&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Location:\"}),\" \",project.location.address]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",gutterBottom:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Coordinates:\"}),\" \",project.location.lat.toFixed(4),\", \",project.location.lng.toFixed(4)]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2,display:'flex',gap:1},children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",onClick:()=>{setSelectedProject(project);setDetailsDialog(true);},children:\"View Details\"}),(project.status==='requires_review'||project.status==='pending_verification')&&/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"contained\",onClick:()=>{setSelectedProject(project);setReviewDialog(true);},children:\"Review\"})]})]})})},project.id);}return null;})]})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83D\\uDCCD Location Statistics\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary.main\",children:projects.filter(p=>p.location&&p.location.lat&&p.location.lng).length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:\"Mapped Projects\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"warning.main\",children:projects.filter(p=>!p.location||!p.location.lat||!p.location.lng).length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:\"Missing Location\"})]})})]})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\uD83C\\uDF0A Ecosystem Distribution\"}),/*#__PURE__*/_jsx(List,{dense:true,children:Object.entries(projects.reduce((acc,project)=>{const ecosystem=project.ecosystem_type||'unknown';acc[ecosystem]=(acc[ecosystem]||0)+1;return acc;},{})).map(_ref=>{let[ecosystem,count]=_ref;return/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:ecosystem.replace('_',' ').toUpperCase(),secondary:\"\".concat(count,\" project\").concat(count>1?'s':'')})},ecosystem);})})]})})})]})});return/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",gutterBottom:true,children:\"\\uD83C\\uDFDB\\uFE0F NCCR Admin Dashboard\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",color:\"textSecondary\",gutterBottom:true,sx:{mb:4},children:\"National Centre for Coastal Research - Blue Carbon MRV System Administration\"}),/*#__PURE__*/_jsx(Alert,{severity:\"warning\",sx:{mb:3},children:\"Review and approve blue carbon restoration projects for MRV workflow\"}),/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider',mb:3},children:/*#__PURE__*/_jsxs(Tabs,{value:activeTab,onChange:(e,newValue)=>setActiveTab(newValue),children:[/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(DashboardIcon,{}),label:\"Dashboard\",iconPosition:\"start\"}),/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(Badge,{badgeContent:projects.filter(p=>p.status==='requires_review'||p.status==='pending_verification').length,color:\"error\",children:/*#__PURE__*/_jsx(VerifiedIcon,{})}),label:\"Project Review\",iconPosition:\"start\"}),/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(AnalyticsIcon,{}),label:\"Analytics\",iconPosition:\"start\"}),/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(MapIcon,{}),label:\"Location Map\",iconPosition:\"start\"})]})}),activeTab===0&&renderDashboardTab(),activeTab===1&&renderProjectsTab(),activeTab===2&&renderAnalyticsTab(),activeTab===3&&renderMapTab(),/*#__PURE__*/_jsxs(Dialog,{open:reviewDialog,onClose:()=>setReviewDialog(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Review Project: \",selectedProject===null||selectedProject===void 0?void 0:selectedProject.project_name]}),/*#__PURE__*/_jsx(DialogContent,{children:selectedProject&&/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Project Details\"}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",selectedProject.id]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ecosystem:\"}),\" \",selectedProject.ecosystem_type]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Area:\"}),\" \",selectedProject.area_hectares,\" hectares\"]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"AI Score:\"}),\" \",selectedProject.verification_score||0,\"/100\"]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",selectedProject.status]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Media Evidence\"}),/*#__PURE__*/_jsxs(Typography,{children:[\"\\uD83D\\uDCF7 Photos: \",((_selectedProject$medi=selectedProject.media_count)===null||_selectedProject$medi===void 0?void 0:_selectedProject$medi.photos)||0]}),/*#__PURE__*/_jsxs(Typography,{children:[\"\\uD83C\\uDFA5 Videos: \",((_selectedProject$medi2=selectedProject.media_count)===null||_selectedProject$medi2===void 0?void 0:_selectedProject$medi2.videos)||0]}),/*#__PURE__*/_jsxs(Typography,{children:[\"\\uD83C\\uDF99\\uFE0F Audio: \",((_selectedProject$medi3=selectedProject.media_count)===null||_selectedProject$medi3===void 0?void 0:_selectedProject$medi3.audio)||0]}),/*#__PURE__*/_jsxs(Typography,{children:[\"\\uD83D\\uDCC4 Documents: \",((_selectedProject$medi4=selectedProject.media_count)===null||_selectedProject$medi4===void 0?void 0:_selectedProject$medi4.documents)||0]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,sx:{mb:2},children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Decision\"}),/*#__PURE__*/_jsxs(Select,{value:reviewData.decision,onChange:e=>setReviewData(_objectSpread(_objectSpread({},reviewData),{},{decision:e.target.value})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"approved\",children:\"Approve\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"rejected\",children:\"Reject\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"requires_revision\",children:\"Requires Revision\"})]})]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,rows:3,label:\"Review Comments\",value:reviewData.comments||reviewComments,onChange:e=>{setReviewData(_objectSpread(_objectSpread({},reviewData),{},{comments:e.target.value}));setReviewComments(e.target.value);},sx:{mb:2}}),reviewData.decision==='approved'&&/*#__PURE__*/_jsx(TextField,{fullWidth:true,type:\"number\",label:\"Carbon Credits to Award\",value:reviewData.credits_awarded,onChange:e=>setReviewData(_objectSpread(_objectSpread({},reviewData),{},{credits_awarded:e.target.value})),sx:{mb:2}})]})]})})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setReviewDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{color:\"error\",startIcon:/*#__PURE__*/_jsx(Cancel,{}),onClick:()=>reviewData.decision?handleProjectReview(selectedProject===null||selectedProject===void 0?void 0:selectedProject.id,'rejected'):handleReview('reject'),children:\"Reject\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",startIcon:/*#__PURE__*/_jsx(CheckCircle,{}),onClick:()=>reviewData.decision?handleProjectReview(selectedProject===null||selectedProject===void 0?void 0:selectedProject.id,'approved'):handleReview('approve'),disabled:loading,children:loading?/*#__PURE__*/_jsx(CircularProgress,{size:20}):'Approve'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:detailsDialog,onClose:()=>setDetailsDialog(false),maxWidth:\"lg\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Project Details: \",selectedProject===null||selectedProject===void 0?void 0:selectedProject.project_name]}),/*#__PURE__*/_jsx(DialogContent,{children:selectedProject&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsxs(Accordion,{defaultExpanded:true,children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Basic Information\"})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Project ID:\"}),\" \",selectedProject.id]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",selectedProject.project_name]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ecosystem:\"}),\" \",selectedProject.ecosystem_type]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Area:\"}),\" \",selectedProject.area_hectares,\" hectares\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",selectedProject.status]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Created:\"}),\" \",new Date(selectedProject.created_at).toLocaleString()]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Created by:\"}),\" \",selectedProject.created_by]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Contact:\"}),\" \",selectedProject.contact_email]})]})]})})]}),/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"AI Verification Results\"})}),/*#__PURE__*/_jsxs(AccordionDetails,{children:[/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Overall Score:\"}),\" \",selectedProject.verification_score||0,\"/100\"]}),selectedProject.ai_verification&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",children:[\"Confidence Level: \",selectedProject.ai_verification.confidence_level]}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",children:[\"Status: \",selectedProject.ai_verification.status]}),selectedProject.ai_verification.flags&&selectedProject.ai_verification.flags.length>0&&/*#__PURE__*/_jsxs(Box,{sx:{mt:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:\"Flags:\"}),selectedProject.ai_verification.flags.map((flag,index)=>/*#__PURE__*/_jsx(Chip,{label:flag,color:\"warning\",size:\"small\",sx:{mr:1,mt:1}},index))]})]})]})]}),/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Field Measurements\"})}),/*#__PURE__*/_jsx(AccordionDetails,{children:selectedProject.field_measurements&&/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:Object.entries(selectedProject.field_measurements).map(_ref2=>{let[category,data]=_ref2;return/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",sx:{fontWeight:'bold',mb:1},children:category.replace('_',' ').toUpperCase()}),Object.entries(data||{}).map(_ref3=>{let[key,value]=_ref3;return value&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[key.replace('_',' '),\": \",value]},key);})]},category);})})})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setDetailsDialog(false),children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(ShareIcon,{}),children:\"Generate Report\"})]})]})]});};export default AdminDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}