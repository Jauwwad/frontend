{"ast":null,"code":"import _objectSpread from\"/Users/razashaikh/Desktop/sih/python-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Dialog,DialogTitle,DialogContent,DialogActions,Button,Grid,Card,CardMedia,CardContent,Typography,Box,Chip,IconButton,Tooltip,CircularProgress,Alert,Tabs,Tab,Paper}from'@mui/material';import{Photo as PhotoIcon,VideoFile as VideoIcon,Description as DocumentIcon,AudioFile as AudioIcon,Download as DownloadIcon,Launch as LaunchIcon,Info as InfoIcon}from'@mui/icons-material';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const IPFSMediaViewer=_ref=>{let{open,onClose,projectId,projectName}=_ref;const[mediaData,setMediaData]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[selectedTab,setSelectedTab]=useState(0);const[selectedMedia,setSelectedMedia]=useState(null);const[mediaDetailDialog,setMediaDetailDialog]=useState(false);useEffect(()=>{if(open&&projectId){fetchMediaData();}},[open,projectId]);const fetchMediaData=async()=>{setLoading(true);setError(null);try{const response=await fetch(\"http://localhost:8002/api/ipfs/files/\".concat(projectId));const data=await response.json();if(data.status==='success'){setMediaData(data.media);}else{setError('Failed to load media data');}}catch(err){setError('Error connecting to server');console.error('Error fetching media:',err);}finally{setLoading(false);}};const getMediaIcon=type=>{switch(type){case'photos':return/*#__PURE__*/_jsx(PhotoIcon,{});case'videos':return/*#__PURE__*/_jsx(VideoIcon,{});case'documents':return/*#__PURE__*/_jsx(DocumentIcon,{});case'audio':return/*#__PURE__*/_jsx(AudioIcon,{});default:return/*#__PURE__*/_jsx(DocumentIcon,{});}};const getMediaColor=type=>{switch(type){case'photos':return'#4caf50';case'videos':return'#2196f3';case'documents':return'#ff9800';case'audio':return'#9c27b0';default:return'#757575';}};const formatFileSize=bytes=>{if(bytes===0)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i];};const formatDate=dateString=>{try{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});}catch(_unused){return'Unknown date';}};const handleMediaClick=(media,type)=>{setSelectedMedia(_objectSpread(_objectSpread({},media),{},{type}));setMediaDetailDialog(true);};const renderMediaGrid=(mediaArray,type)=>{if(!mediaArray||mediaArray.length===0){return/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center',py:4},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"No \",type,\" available\"]})});}return/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,sx:{mt:1},children:mediaArray.map((media,index)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{sx:{cursor:'pointer',transition:'transform 0.2s','&:hover':{transform:'scale(1.02)'}},onClick:()=>handleMediaClick(media,type),children:[type==='photos'&&/*#__PURE__*/_jsx(CardMedia,{component:\"img\",height:140,image:media.gateway_url,alt:media.filename,sx:{objectFit:'cover'},onError:e=>{e.target.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIxIDNIMy4xOCNBMjAhMiAwMC0tMiAydjEuODJMMjEgMjF6IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+';}}),type==='videos'&&/*#__PURE__*/_jsx(Box,{sx:{height:140,display:'flex',alignItems:'center',justifyContent:'center',bgcolor:'#f5f5f5'},children:/*#__PURE__*/_jsx(VideoIcon,{sx:{fontSize:48,color:getMediaColor(type)}})}),(type==='documents'||type==='audio')&&/*#__PURE__*/_jsxs(Box,{sx:{height:140,display:'flex',alignItems:'center',justifyContent:'center',bgcolor:'#f5f5f5'},children:[getMediaIcon(type),/*#__PURE__*/_jsx(Box,{sx:{fontSize:48,color:getMediaColor(type)}})]}),/*#__PURE__*/_jsxs(CardContent,{sx:{p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",noWrap:true,children:media.filename}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",display:\"block\",children:formatDate(media.uploaded_at)}),media.size&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",display:\"block\",children:formatFileSize(media.size)}),/*#__PURE__*/_jsx(Box,{sx:{mt:1},children:/*#__PURE__*/_jsx(Chip,{label:\"IPFS: \".concat(media.ipfs_hash.substring(0,8),\"...\"),size:\"small\",variant:\"outlined\",sx:{fontSize:'0.7rem'}})})]})]})},index))});};const mediaTypes=[{key:'photos',label:'Photos',icon:/*#__PURE__*/_jsx(PhotoIcon,{})},{key:'videos',label:'Videos',icon:/*#__PURE__*/_jsx(VideoIcon,{})},{key:'documents',label:'Documents',icon:/*#__PURE__*/_jsx(DocumentIcon,{})},{key:'audio',label:'Audio',icon:/*#__PURE__*/_jsx(AudioIcon,{})}];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:onClose,maxWidth:\"lg\",fullWidth:true,PaperProps:{sx:{height:'90vh'}},children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(PhotoIcon,{color:\"primary\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"IPFS Media - \",projectName]})]})}),/*#__PURE__*/_jsxs(DialogContent,{children:[loading&&/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',py:4},children:/*#__PURE__*/_jsx(CircularProgress,{})}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),mediaData&&!loading&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Paper,{sx:{mb:2},children:/*#__PURE__*/_jsx(Tabs,{value:selectedTab,onChange:(e,newValue)=>setSelectedTab(newValue),variant:\"fullWidth\",children:mediaTypes.map((type,index)=>{var _mediaData$type$key;const count=((_mediaData$type$key=mediaData[type.key])===null||_mediaData$type$key===void 0?void 0:_mediaData$type$key.length)||0;return/*#__PURE__*/_jsx(Tab,{icon:type.icon,label:\"\".concat(type.label,\" (\").concat(count,\")\"),iconPosition:\"start\"},type.key);})})}),mediaTypes.map((type,index)=>/*#__PURE__*/_jsx(Box,{hidden:selectedTab!==index,children:renderMediaGrid(mediaData[type.key],type.key)},type.key))]})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:onClose,children:\"Close\"})})]}),/*#__PURE__*/_jsxs(Dialog,{open:mediaDetailDialog,onClose:()=>setMediaDetailDialog(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Media Details\"}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Open in IPFS Gateway\",children:/*#__PURE__*/_jsx(IconButton,{href:selectedMedia===null||selectedMedia===void 0?void 0:selectedMedia.gateway_url,target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(LaunchIcon,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Download\",children:/*#__PURE__*/_jsx(IconButton,{href:selectedMedia===null||selectedMedia===void 0?void 0:selectedMedia.gateway_url,download:selectedMedia===null||selectedMedia===void 0?void 0:selectedMedia.filename,children:/*#__PURE__*/_jsx(DownloadIcon,{})})})]})]})}),/*#__PURE__*/_jsx(DialogContent,{children:selectedMedia&&/*#__PURE__*/_jsxs(Box,{children:[selectedMedia.type==='photos'&&/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center',mb:2},children:/*#__PURE__*/_jsx(\"img\",{src:selectedMedia.gateway_url,alt:selectedMedia.filename,style:{maxWidth:'100%',maxHeight:'400px',objectFit:'contain'}})}),selectedMedia.type==='videos'&&/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center',mb:2},children:/*#__PURE__*/_jsxs(\"video\",{controls:true,style:{maxWidth:'100%',maxHeight:'400px'},children:[/*#__PURE__*/_jsx(\"source\",{src:selectedMedia.gateway_url}),\"Your browser does not support video playback.\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:selectedMedia.filename}),selectedMedia.description&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Description:\"}),\" \",selectedMedia.description]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"IPFS Hash:\"}),\" \",selectedMedia.ipfs_hash]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Uploaded:\"}),\" \",formatDate(selectedMedia.uploaded_at)]}),selectedMedia.size&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"File Size:\"}),\" \",formatFileSize(selectedMedia.size)]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",paragraph:true,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Gateway URL:\"}),' ',/*#__PURE__*/_jsx(\"a\",{href:selectedMedia.gateway_url,target:\"_blank\",rel:\"noopener noreferrer\",style:{wordBreak:'break-all'},children:selectedMedia.gateway_url})]})]})]})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>setMediaDetailDialog(false),children:\"Close\"})})]})]});};export default IPFSMediaViewer;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}